class GcComponent extends HTMLElement{constructor(){super(),this.id=this.id||this.guid(),this._cache={events:{}},this.useNativeShadow=-1!=window.customElements.toString().indexOf("CustomElementRegistry"),this.useNativeShadow?(console.log("Good browser, use Shadow DOM"),this.shadowSelector=":host"):(console.log("Not good browser, don't use Shadow DOM"),this.shadowSelector=`#${this.id}`)}$(t){return this.querySelector(t)}$$(t){return this.querySelectorAll(t)}fireEvent(t,e,s=!0){const i=JSON.stringify(arguments);if(!(i in this._cache.events)){const o={bubbles:s};e instanceof Object&&(o.detail=e),this._cache.events[i]=new CustomEvent(t,o)}this.dispatchEvent(this._cache.events[i])}loadScript(t,e){console.log(`Loading ${t}`);var s=document.getElementsByTagName("head")[0],i=document.createElement("script");i.type="text/javascript",i.src=t,i.onload=e,s.appendChild(i)}guid(){function t(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return`c${t()}${t()}${t()}${t()}${t()}${t()}${t()}${t()}`}makeShadow(t={}){this.useNativeShadow?this.attachShadow({mode:"open"}):this.shadowRoot=this,this.shadowRoot.$=(t=>this.shadowRoot.querySelector(t)),this.shadowRoot.$$=(t=>new CustomNodeList(this.shadowRoot.querySelectorAll(t)))}get is(){return this.localName}}!function(){var t;["webkitM","mozM","msM","oM","m"].some(function(e){var s=e+"atches";return s in document.documentElement&&(t=s),(s+="Selector")in document.documentElement&&(t=s),t});var e=!document.documentMode||document.documentMode>9,s=window.chrome,i=s&&(s.webstore||s.app),o=/Apple/.test(navigator.vendor)&&/Version\/([6-9]\d*|[1-5]\d+)/.test(navigator.userAgent);function n(t){this.element=t.element,this.document=t.element.ownerDocument,"function"==typeof t.ignoreTarget&&(this.ignoreTarget=t.ignoreTarget),this.onActiveChanged=t.onActiveChanged,this.activate=this.activate.bind(this),this.deactivate=this.deactivate.bind(this),this.toggle=this.toggle.bind(this),this._onmousedown=this._onmousedown.bind(this),this._onmousemove=this._onmousemove.bind(this),this._endPan=this._endPan.bind(this),(this.overlay=document.createElement("div")).className="grab-to-pan-grabbing"}n.prototype={CSS_CLASS_GRAB:"grab-to-pan-grab",activate:function(){this.active||(this.active=!0,this.element.addEventListener("mousedown",this._onmousedown,!0),this.element.classList.add(this.CSS_CLASS_GRAB),this.onActiveChanged&&this.onActiveChanged(!0))},deactivate:function(){this.active&&(this.active=!1,this.element.removeEventListener("mousedown",this._onmousedown,!0),this._endPan(),this.element.classList.remove(this.CSS_CLASS_GRAB),this.onActiveChanged&&this.onActiveChanged(!1))},toggle:function(){this.active?this.deactivate():this.activate()},ignoreTarget:function(e){return e[t]("a[href], a[href] *, input, textarea, button, button *, select, option")},_onmousedown:function(t){if(0===t.button&&!this.ignoreTarget(t.target)){if(t.originalTarget)try{t.originalTarget.tagName}catch(t){return}this.scrollLeftStart=this.element.scrollLeft,this.scrollTopStart=this.element.scrollTop,this.clientXStart=t.clientX,this.clientYStart=t.clientY,this.document.addEventListener("mousemove",this._onmousemove,!0),this.document.addEventListener("mouseup",this._endPan,!0),this.element.addEventListener("scroll",this._endPan,!0),t.preventDefault(),t.stopPropagation();var e=document.activeElement;e&&!e.contains(t.target)&&e.blur()}},_onmousemove:function(t){if(this.element.removeEventListener("scroll",this._endPan,!0),function(t){return"buttons"in t&&e?!(1&t.buttons):i||o?0===t.which:void 0}(t))this._endPan();else{var s=t.clientX-this.clientXStart,n=t.clientY-this.clientYStart,a=this.scrollTopStart-n,h=this.scrollLeftStart-s;this.element.scrollTo?this.element.scrollTo({top:a,left:h,behavior:"instant"}):(this.element.scrollTop=a,this.element.scrollLeft=h),this.overlay.parentNode||document.body.appendChild(this.overlay)}},_endPan:function(){this.element.removeEventListener("scroll",this._endPan,!0),this.document.removeEventListener("mousemove",this._onmousemove,!0),this.document.removeEventListener("mouseup",this._endPan,!0),this.overlay.remove()}};customElements.define("gc-pdfviewer",class extends GcComponent{constructor(){super(),this.pdfjsLib=window["pdfjs-dist/build/pdf"];const t=`${this.shadowSelector} .scrollview{width:${this.getAttribute("width")||"100%"};height:${this.getAttribute("height")||"400px"};overflow:auto;} \n${this.shadowSelector} canvas{cursor:pointer;} `;if(this.makeShadow(),this.messages={"not-supported-message":this.getAttribute("not-supported-message")||"No pdf support","not-supported-link-message":this.getAttribute("not-supported-link-message")||"Click here to download file"},!this.pdfjsLib)return console.error("pdfjsLib not found"),void(this.shadowRoot.innerHTML=`${this.messages["not-supported-message"]}<a src='${this.file}'>${this.messages["not-supported-link-message"]}`);this.shadowRoot.innerHTML=`<style>${t}</style><div class="scrollview"><canvas></canvas></div>`,this.theStyle=this.shadowRoot.$("style"),this.theCanvas=this.shadowRoot.$("canvas"),this.grabToPan=new n({element:this.shadowRoot.$(".scrollview")}),this.grabToPan.activate(),console.log(`this.theStyle=${this.theStyle} this.theCanvas=${this.theCanvas}`)}loadPage(t){this.pdfdoc.getPage(t).then(e=>{var s=e.getViewport(1),i=this.theCanvas.getContext("2d");this.theCanvas.height=s.height,this.theCanvas.width=s.width;var o={canvasContext:i,viewport:s};e.render(o).then(()=>{console.log("Page rendered"),this._loadingLock=!1,this.fireEvent("pagerendered",t)})})}loadFromUrl(t){this.pdfdoc=null,this.pdfjsLib?this._loadingLock?console.log("already laoading.."):(this._loadingLock=!0,this.pdfUrl=t,this.pdfjsLib.getDocument(this.pdfUrl).promise.then(t=>{try{this.pdfdoc=t;let s=this.offsetHeight;this.offsetWidth;const i=window.getComputedStyle(this,null).getPropertyValue("height");i&&(s=1*i),this.fireEvent("documentload");var e=this.pagenum;this.loadPage(e)}catch(t){this._loadingLock=!1,console.log(`Error: ${t}`)}},t=>{this._loadingLock=!1,console.error(t)})):console.error("pdfjsLib not found")}get file(){return this.getAttribute("file")}set file(t){t?this.setAttribute("file",t):this.removeAttribute("file")}get pagenum(){if(!this.getAttribute("pagenum"))return 1}set pagenum(t){this.setAttribute("pagenum",t)}attributeChangedCallback(t,e,s){switch(t){case"file":this.loadFromUrl(s);break;case"pagenum":this.loadPage(1*s)}}static get observedAttributes(){return["file","pagenum"]}})}();